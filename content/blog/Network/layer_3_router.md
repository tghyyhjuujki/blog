---
title: Network) OSI 3계층-네트워크 계층 - 라우팅
date: 2020-11-05
category: Network
draft: false
---

###  MAC주소와 IP주소의 기능적 차이

MAC주소는 다음 수신처이다. 반면 IP주소는 최종 수신처이다. 즉, 목표하는 IP까지 도달하기 위해서는 각 라우터의 MAC주소를 거쳐서 가는 것이라 할 수 있다.

<br/>

### 홉 바이 홉

경로를 찾을 때 MAC주소와 IP주소를 가지고 반복해서 다음 길(라우터)로 나아간다. 이것을 홉 바이 홉이라고 한다. 홉이란 라우팅에서 라우터를 가르킴.

<br/>

### 라우터

네트워크와 네트워크의 경계상에 배치되는 장치로, 다른 네트워크에 데이터그램을 보내는 역할을 하기 때문에 복수의 인터페이스를 가진다(라우터에 여러 개의 네트워크가 연결된 것을 생각해보면 됨).

또한 특정 조건에서 데이터그램을 파기하는 필터링을 하기도 함.

<br/>

### 라우팅 테이블

최적의 경로지도라고 생각하면 된다. 이 테이블에는 수신처네트워크까지의 거리, 다음에 도달하는 라우터, 그 라우터에 연결되어있는 자신의 인터페이스 등이 기재되어 있다.

<br/>

### 브로드캐스트 도메인

브로드캐스트의 범위. 라우터가 네트워크를 나누기 때문에 브로드캐스트 도메인 = 네트워크라고 생각해도 된다. 그리고 앞에서 나온 충돌 도메인과 비슷하지만 아래와 같은 차이가 있다.

충돌도메인 : 스위치가 구분

브로드캐스트 도메인 : 라우터가 구분

<br/>

### 디폴트 게이트웨이

MAC주소는 ARP를 이용하여 알아낼 수 있다. 또한 브로드캐스트는 라우터를 넘어서 전송할 수 없다고 했었다. 하지만 ARP는 브로드캐스트라서 라우터를 넘지 못한다. 그럼 MAC주소를 알 방법이 없을까? 

디폴트 게이트웨이라는 네트워크의 출입문이 존재한다. 컴퓨터가 최초로 데이터를 보내는 수신처는 이 디폴트 게이트웨이가 된다. 즉 컴퓨터는 다른 네트워크에 데이터를 송신할 때 디폴트 게이트웨이로 ARP를 수행해서 최종 목적지까지 도달할 수 있다. 

좀 더 자세히 알아보자면,

먼저 호스트A는 ARP로 디폴트 게이트웨이의 MAC주소를 알아낸다(디폴트 게이트웨이로 갔다가 다시 호스트A로 돌아옴). 그 정보를 가지고 다시 라우터에 패킷을 보낸다.

![image-20201114183841938](layer_3_router.assets/image-20201114183841938.png)

<br/>

그러면 패킷은 다음과 같은 정보를 가질 것이다.

| 수신처MAC | 송신처MAC | 송신처IP | 수신처IP |
| --------- | --------- | -------- | -------- |
| 라우터    | 호스트A   | 호스트A  | 호스트B  |

<br/>

수신 받은 디폴트 게이트웨이는 다시 수신받을 상대에게 ARP를 수행한다.

![image-20201114184006423](layer_3_router.assets/image-20201114184006423.png)

<br/>

그러면 패킷은 다음과 같은 정보를 갖고 있을 것이다.

| 수신처MAC | 송신처MAC | 송신처IP | 수신처IP |
| --------- | --------- | -------- | -------- |
| 호스트B   | 라우터    | 호스트A  | 호스트B  |

참고로 디폴트 게이트웨이의 IP주소를 알고 있어야 홉 바이 홉을 통해 최종 목적지까지 도달할 수 있다.